!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).ADID=t()}(this,function(){"use strict";function e(n,r){var o,a,i,e,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,a&&(i=2&t[0]?a.return:t[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,t[1])).done)return i;switch(a=0,i&&(t=[2&t[0],i.value]),t[0]){case 0:case 1:i=t;break;case 4:return c.label++,{value:t[1],done:!1};case 5:c.label++,a=t[1],t=[0];continue;case 7:t=c.ops.pop(),c.trys.pop();continue;default:if(!(i=0<(i=c.trys).length&&i[i.length-1])&&(6===t[0]||2===t[0])){c=0;continue}if(3===t[0]&&(!i||t[1]>i[0]&&t[1]<i[3])){c.label=t[1];break}if(6===t[0]&&c.label<i[1]){c.label=i[1],i=t;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(t);break}i[2]&&c.ops.pop(),c.trys.pop();continue}t=r.call(n,c)}catch(e){t=[6,e],a=0}finally{o=i=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}function o(){return"undefined"!=typeof crypto?(""+1e7+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(Number(e)^crypto.getRandomValues(new Uint8Array(1))[0]&15>>Number(e)/4).toString(16)}):"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}var t,n,l={buf2hex:function(e){return Array.prototype.map.call(new Uint8Array(e),function(e){return("00"+e.toString(16)).slice(-2)}).join("")},hash:function(e){return crypto.subtle.digest("SHA-256",e)},hashes:{red:"e1611c0f76dfefc367d7e5411993eaf1295aafcb5f7b574157b3e686a789380c"}},s={canvas:!1,textApi:!1,toDataURL:!1};function f(e){void 0===e&&(e="binary");var t=document.createElement("canvas");t.width=256,t.height=24;var n=t.getContext("2d"),r="WeBrowserTools.com <canvas> 1.0";if(!n)return Promise.reject("");n.textBaseline="middle",n.font='14px "Arial"',n.textBaseline="alphabetic",n.fillStyle="rgb(255, 102, 0)",n.fillRect(t.width/4,0,t.width/2,t.height),n.fillStyle="rgb(0, 102, 153)",n.fillText(r,2,15),n.fillStyle="rgb(102, 204, 0)",n.fillText(r,4,17);var o=new TextEncoder,a="binary"===e?n.getImageData(0,0,t.width,t.height).data.buffer:o.encode(t.toDataURL());return l.hash(a).then(l.buf2hex)}return t=document.createElement("canvas"),n=t.getContext("2d"),s.canvas=!(!t.getContext||!t.getContext("2d")),s.textApi=!(!t.getContext||!n||!n.fillText),s.toDataURL=!(!t.getContext||!t.toDataURL),function(){return a=this,u=function(){var t,n,r;return e(this,function(e){switch(e.label){case 0:return s.canvas&&s.textApi&&s.toDataURL?"https:"!==window.location.protocol?(console.warn("\nAccording to https://www.chromium.org/blink/webcrypto, crypto api is only available under https.\nPlease run script under a https domain"),[2,{supportive:s,ADID:o(),message:"Please run script under a https domain"}]):[4,function(){var e=document.createElement("canvas");e.width=256,e.height=24;var t=e.getContext("2d");if(!t)return Promise.reject();t.fillStyle="rgb(255, 0, 0)",t.fillRect(4,4,e.width-8,e.height-8);var n=t.getImageData(0,0,e.width,e.height).data.buffer;return l.hash(n).then(l.buf2hex)}()]:[2,{supportive:s,ADID:o(),message:"Canvas api is not support on current browser."}];case 1:return t=e.sent(),[4,f("png")];case 2:return n=e.sent(),[4,new Promise(function(e,t){window.addEventListener("load",function(){f("png").then(e,t)})})];case 3:return r=e.sent(),[2,{supportive:s,spoofed:t!==l.hashes.red||r!==n,spoofedByRandom:r!==n,ADID:r,spoofedRandomBefore:n,spoofedRandomAfter:r}]}})},new(c=(c=i=void 0)||Promise)(function(e,t){function n(e){try{o(u.next(e))}catch(e){t(e)}}function r(e){try{o(u.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new c(function(e){e(t.value)}).then(n,r)}o((u=u.apply(a,i||[])).next())});var a,i,c,u}});
